# GitHub Copilot Coding Agent Environment Configuration for Apex Coach AI
# Reference: https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/customize-the-agent-environment
#
# IMPORTANT: This file should ONLY contain non-sensitive configuration.
# Secrets (API keys, connection strings) should be managed via:
# - Azure Key Vault (recommended)
# - GitHub Copilot environment secrets (if available)
# - Secure environment variable injection

name: apex-coach-ai-agent-environment

# Setup steps run before each Copilot Coding Agent session
setup:
  - name: Install Node.js and pnpm
    run: |
      # Node.js 22.x is already available in GitHub Codespaces
      npm install -g pnpm@10.0.0

  - name: Install project dependencies
    run: |
      pnpm install --frozen-lockfile

  - name: Verify monorepo structure
    run: |
      echo "Monorepo workspace packages:"
      pnpm list --depth 0

# Environment variables - ONLY non-sensitive configuration
# Secrets should be injected via secure methods (Key Vault, environment secrets)
env:
  # Azure OpenAI Configuration (endpoints only - no keys)
  AZURE_OPENAI_ENDPOINT: https://shared-openai-eastus2.openai.azure.com/
  AZURE_OPENAI_RESOURCE: shared-openai-eastus2
  AZURE_OPENAI_CHAT_DEPLOYMENT: gpt-5.1
  AZURE_OPENAI_EMBED_DEPLOYMENT: text-embedding-3-large
  AZURE_OPENAI_EMBEDDING_DEPLOYMENT: text-embedding-3-small
  AZURE_OPENAI_API_VERSION: 2025-01-01-preview

  # Azure AI Services Configuration (endpoints only)
  AZURE_AI_ENDPOINT: https://shared-openai-eastus2.cognitiveservices.azure.com/
  AZURE_DOCINT_ENDPOINT: https://shared-openai-eastus2.cognitiveservices.azure.com/
  AZURE_LANGUAGE_ENDPOINT: https://shared-openai-eastus2.cognitiveservices.azure.com/
  AZURE_SPEECH_ENDPOINT: https://shared-openai-eastus2.cognitiveservices.azure.com/
  AZURE_VISION_ENDPOINT: https://shared-openai-eastus2.cognitiveservices.azure.com/

  # Azure AI Search (endpoint only - no API key)
  AZURE_SEARCH_ENDPOINT: https://shared-search-standard-eastus2.search.windows.net
  AZURE_SEARCH_INDEX_NAME: apexcoach-ai-index

  # Azure Storage (account name only - no connection string)
  AZURE_STORAGE_ACCOUNT: stmahumsharedapps
  AZURE_STORAGE_BLOB_ENDPOINT: https://stmahumsharedapps.blob.core.windows.net/
  AZURE_STORAGE_CONTAINER: indrive

  # PostgreSQL (host only - no password)
  PGHOST: pg-shared-apps-eastus2.postgres.database.azure.com
  PGPORT: 5432
  PGSSLMODE: require

  # Application Context
  APP_NAME: apex-coach-ai
  APP_BASE_URL: https://apexcoach.shtrial.com
  APP_ENV: development

  # Tech Stack
  NODE_VERSION: 22.x
  PNPM_VERSION: 10.0.0

tools:
  - name: node
    version: 22.x
  - name: pnpm
    version: 10.0.0

focus_directories:
  - packages/webapp/src
  - packages/search/src
  - packages/indexer/src
  - packages/chat-component/src

ignore_patterns:
  - "**/node_modules/**"
  - "**/dist/**"
  - "**/*.log"
  - "**/.env.local"
  - "**/.env"
  - "**/coverage/**"
